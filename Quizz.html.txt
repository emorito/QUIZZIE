<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>üß† Quiz Psicometr√≠a Plus</title>
<style>
  *{box-sizing:border-box;margin:0;padding:0}
  body{
    font-family:'Segoe UI',Tahoma,Geneva,Verdana,sans-serif;
    background:linear-gradient(135deg,#667eea,#764ba2);
    min-height:100vh;display:flex;align-items:center;justify-content:center;
    padding:20px;color:#2d3748;
  }
  .quiz-container{
    width:100%;max-width:800px;background:white;border-radius:20px;
    box-shadow:0 20px 60px rgba(0,0,0,0.3);overflow:hidden;
    animation:slideIn .6s ease-out;
  }
  @keyframes slideIn{from{opacity:0;transform:translateY(-40px)}to{opacity:1;transform:none}}
  header{
    background:linear-gradient(135deg,#f093fb,#f5576c);
    color:white;text-align:center;padding:30px;
  }
  header h1{font-size:2.2em;margin-bottom:10px}
  header p{font-size:1.1em;opacity:.9}
  .quiz-body{padding:35px}
  .question{margin-bottom:28px;padding:22px;border-radius:15px;
    background:#f8f9ff;border-left:5px solid #667eea;}
  .question h3{margin-bottom:16px;font-size:1.2em}
  .options{display:grid;gap:10px}
  .opt{
    background:white;border:2px solid #e2e8f0;border-radius:10px;
    padding:14px 18px;cursor:pointer;display:flex;align-items:center;gap:10px;
    transition:.25s;user-select:none;
  }
  .opt:hover{background:#f7fafc;border-color:#667eea;transform:scale(1.02)}
  .opt.selected{background:#e6fffa;border-color:#667eea}
  .opt.correct{background:#f0fff4;border-color:#48bb78}
  .opt.incorrect{background:#fff5f5;border-color:#f56565}
  .feedback{margin-top:10px;padding:12px;border-radius:10px;font-weight:500;display:none}
  .feedback.ok{background:#c6f6d5;color:#22543d;border-left:4px solid #48bb78}
  .feedback.err{background:#fed7d7;color:#742a2a;border-left:4px solid #f56565}
  .btn{
    background:linear-gradient(135deg,#667eea,#764ba2);
    color:white;border:none;border-radius:50px;
    padding:15px 30px;cursor:pointer;font-size:1.1em;font-weight:bold;
    display:block;margin:25px auto;transition:.3s;
  }
  .btn:hover{transform:translateY(-2px);box-shadow:0 6px 20px rgba(0,0,0,0.25)}
  .result{
    text-align:center;padding:40px;display:none;
  }
  .circle{
    width:180px;height:180px;border-radius:50%;margin:0 auto 25px;
    display:flex;align-items:center;justify-content:center;
    color:white;font-size:2.5em;font-weight:bold;
    animation:pulse 2s infinite;
  }
  @keyframes pulse{0%{transform:scale(1)}50%{transform:scale(1.05)}100%{transform:scale(1)}}
  .circle.perfect{background:linear-gradient(135deg,#48bb78,#38a169)}
  .circle.good{background:linear-gradient(135deg,#ed8936,#dd6b20)}
  .circle.low{background:linear-gradient(135deg,#f56565,#e53e3e)}
  .msg{font-size:1.5em;margin-bottom:12px}
  .details{font-size:1.05em;color:#4a5568;margin-bottom:25px}
  .small{font-size:12px;color:#718096}
</style>
</head>
<body>
<div class="quiz-container">
  <header>
    <h1>üß© Quiz Psicometr√≠a Plus</h1>
    <p>Basado en Mu√±iz & Fonseca-Pedrero (2019) ‚Äì Guarda tus intentos localmente</p>
  </header>

  <div class="quiz-body" id="quizBody"></div>

  <div class="result" id="result">
    <div id="circle" class="circle"></div>
    <div class="msg" id="msg"></div>
    <div class="details" id="details"></div>
    <button class="btn" id="retry">üîÅ Volver a intentar</button>
    <p class="small" id="hist"></p>
  </div>
</div>

<script>
const QUESTIONS = [
  { q:"¬øCu√°l es el primer paso en la construcci√≥n de un test seg√∫n Mu√±iz y Fonseca-Pedrero?",
    opts:["Estudios piloto","Definici√≥n de la variable medida","Marco general","Edici√≥n del test"],
    correct:2,
    fbOk:"üéØ ¬°Correcto! El marco general es el punto de partida fundamental.",
    fbErr:"üìò ¬°Casi! Antes que nada necesitamos establecer el marco general."
  },
  { q:"La definici√≥n operacional de una variable implica:",
    opts:["Describirla solo te√≥ricamente","Traducirla en conductas observables y medibles",
          "Seleccionar √≠tems de otros instrumentos","Dise√±ar √≠tems tipo Likert"],
    correct:1,
    fbOk:"üß† ¬°Exacto! Operacionalizar es hacerla observable y medible.",
    fbErr:"üí° No basta con definirla: hay que volverla medible. ¬°T√∫ puedes!"
  },
  { q:"¬øCu√°l es el prop√≥sito principal del estudio piloto?",
    opts:["Analizar el error de medici√≥n","Evaluar la comprensi√≥n y funcionamiento de los √≠tems",
          "Calcular los baremos del test","Obtener la versi√≥n final del instrumento"],
    correct:1,
    fbOk:"üöÄ ¬°As√≠ se hace! El piloto prueba el funcionamiento real de los √≠tems.",
    fbErr:"üß™ Es un ensayo general, sirve para detectar fallos de comprensi√≥n. ¬°Int√©ntalo otra vez!"
  },
  { q:"En el proceso de validaci√≥n, la fiabilidad se refiere a:",
    opts:["La precisi√≥n de las puntuaciones","La relevancia del contenido",
          "La est√©tica del instrumento","La dificultad media de los √≠tems"],
    correct:0,
    fbOk:"üåü ¬°Perfecto! Fiabilidad = precisi√≥n y consistencia de las puntuaciones.",
    fbErr:"üîç No confundir: la fiabilidad no es validez, es precisi√≥n. ¬°Vamos!"
  },
  { q:"¬øQu√© caracteriza a la versi√≥n final del test?",
    opts:["Es la primera prueba emp√≠rica","Surge tras analizar validez y fiabilidad",
          "Se usa solo para pilotos","No requiere manual de uso"],
    correct:1,
    fbOk:"üèÜ ¬°Brillante! Es el resultado de todo el proceso psicom√©trico.",
    fbErr:"üìö Falta un paso: la versi√≥n final viene despu√©s de analizar fiabilidad y validez."
  }
];

const LS_KEY="quiz_psico_attempts_v2";
let answers={};

function renderQuiz(){
  const body=document.getElementById('quizBody');
  body.innerHTML="";
  QUESTIONS.forEach((q,idx)=>{
    const block=document.createElement('div');
    block.className="question";
    block.dataset.index=idx;
    block.innerHTML=`
      <h3>${idx+1}. ${q.q}</h3>
      <div class="options">
        ${q.opts.map((o,i)=>`
          <div class="opt" data-i="${i}"><strong>${String.fromCharCode(65+i)}.</strong> ${o}</div>
        `).join("")}
      </div>
      <div class="feedback ok">${q.fbOk}</div>
      <div class="feedback err">${q.fbErr}</div>
    `;
    body.appendChild(block);
  });
  const btn=document.createElement('button');
  btn.textContent="üéØ Ver mis resultados";
  btn.className="btn";
  btn.onclick=calcResults;
  body.appendChild(btn);
  attachListeners();
}

function attachListeners(){
  document.querySelectorAll('.opt').forEach(opt=>{
    opt.onclick=()=>{
      const block=opt.closest('.question');
      block.querySelectorAll('.opt').forEach(o=>o.classList.remove('selected','correct','incorrect'));
      opt.classList.add('selected');
      const i=parseInt(opt.dataset.i);
      const idx=parseInt(block.dataset.index);
      answers[idx]=i;
      block.querySelectorAll('.feedback').forEach(f=>f.style.display='none');
      if(i===QUESTIONS[idx].correct){
        opt.classList.add('correct');
        block.querySelector('.feedback.ok').style.display='block';
      }else{
        opt.classList.add('incorrect');
        block.querySelector('.feedback.err').style.display='block';
      }
    };
  });
}

function calcResults(){
  let correct=0;
  QUESTIONS.forEach((q,i)=>{ if(answers[i]===q.correct) correct++; });
  const pct=Math.round((correct/QUESTIONS.length)*100);
  saveAttempt(pct,correct);
  showResults(pct,correct);
}

function showResults(pct,correct){
  document.getElementById('quizBody').style.display='none';
  const res=document.getElementById('result');
  const circle=document.getElementById('circle');
  const msg=document.getElementById('msg');
  const det=document.getElementById('details');
  res.style.display='block';
  circle.textContent=`${correct}/${QUESTIONS.length}`;
  circle.className="circle";
  if(pct===100){circle.classList.add('perfect');msg.textContent="üéâ ¬°Perfecto!";det.textContent="¬°Eres todo un experto psicometrista!";}
  else if(pct>=60){circle.classList.add('good');msg.textContent="üëè ¬°Muy bien!";det.textContent=`Acertaste ${correct} de ${QUESTIONS.length}. ¬°Buena base psicom√©trica!`;}
  else{circle.classList.add('low');msg.textContent="üí™ ¬°√Ånimo!";det.textContent=`Solo ${correct} de ${QUESTIONS.length}. Repasa los pasos de Mu√±iz y vuelve a intentarlo.`;}
  document.getElementById('hist').textContent=`Intentos guardados: ${loadAttempts().length}`;
}

function saveAttempt(pct,correct){
  const list=loadAttempts();
  list.push({ts:new Date().toLocaleString(),pct,correct});
  localStorage.setItem(LS_KEY,JSON.stringify(list));
}

function loadAttempts(){
  try{return JSON.parse(localStorage.getItem(LS_KEY))||[]}catch(e){return [];}
}

document.getElementById('retry').onclick=()=>{
  document.getElementById('result').style.display='none';
  document.getElementById('quizBody').style.display='block';
  answers={};
  renderQuiz();
};

document.addEventListener('DOMContentLoaded',()=>renderQuiz());
</script>
</body>
</html>